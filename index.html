<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>æ—©å®‰åœ–ç”Ÿæˆå™¨ï¼ˆæ—¥æœŸï¼‹å¤©æ°£ï¼‹é‡‘å¥ç‰ˆï¼‰</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background: #f0f0f0;
      font-size: 20px;
    }
    h2 {
      font-size: 26px;
    }
    canvas {
      border: 1px solid #ccc;
      margin-top: 20px;
      max-width: 100%;
    }
    button {
      margin: 8px;
      font-size: 18px;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      background-color: #4CAF50;
      color: white;
      border: none;
    }
    button:hover {
      background-color: #45a049;
    }
    #outputImage {
      margin-top: 20px;
      max-width: 100%;
      border: 1px solid #ccc;
    }
    input[type="file"], select, input[type="text"] {
      font-size: 20px;
      padding: 6px 12px;
      margin: 10px;
    }
  </style>
</head>
<body>
  <h2>ğŸŒ… æ—©å®‰åœ–ç”Ÿæˆå™¨ï¼ˆæ—¥æœŸï¼‹å¤©æ°£ï¼‹é‡‘å¥ç‰ˆï¼‰</h2>
  <input type="file" id="upload" accept="image/*"><br>
  
  <select id="city">
    <option value="è‡ºåŒ—å¸‚" selected>è‡ºåŒ—å¸‚</option>
    <option value="æ–°åŒ—å¸‚">æ–°åŒ—å¸‚</option>
    <option value="æ¡ƒåœ’å¸‚">æ¡ƒåœ’å¸‚</option>
    <option value="è‡ºä¸­å¸‚">è‡ºä¸­å¸‚</option>
    <option value="è‡ºå—å¸‚">è‡ºå—å¸‚</option>
    <option value="é«˜é›„å¸‚">é«˜é›„å¸‚</option>
    <option value="æ–°ç«¹å¸‚">æ–°ç«¹å¸‚</option>
    <option value="å˜‰ç¾©å¸‚">å˜‰ç¾©å¸‚</option>
    <option value="èŠ±è“®ç¸£">èŠ±è“®ç¸£</option>
    <option value="è‡ºæ±ç¸£">è‡ºæ±ç¸£</option>
  </select>
  
  <br>
  ä¸Šæ’æ–‡å­—ï¼š
  <input type="text" id="topText" value="è¦ªå‹å€‘ï¼Œæ—©å®‰ï¼"><br>
  
  ä¸‹æ’é‡‘å¥ï¼š
  <input type="text" id="bottomQuote" placeholder="ç•™ç©ºå‰‡éš¨æ©Ÿé‡‘å¥"><br>
  
  ä¸Šæ’å­—å¤§å°ï¼š
  <button onclick="adjustSize('top', -0.01)">ï¼</button>
  <span id="topSizeDisplay">0.08</span>
  <button onclick="adjustSize('top', 0.01)">ï¼‹</button>
  <br>
  ä¸‹æ’å­—å¤§å°ï¼š
  <button onclick="adjustSize('bottom', -0.01)">ï¼</button>
  <span id="bottomSizeDisplay">0.04</span>
  <button onclick="adjustSize('bottom', 0.01)">ï¼‹</button>
  <br>
  
  ä¸Šæ’å­—ä½ç½®ï¼š
  <button onclick="adjustOffset('top', -0.02)">ï¼</button>
  <span id="topOffsetDisplay">0.15</span>
  <button onclick="adjustOffset('top', 0.02)">ï¼‹</button>
  <br>
  ä¸‹æ’å­—ä½ç½®ï¼š
  <button onclick="adjustOffset('bottom', -0.02)">ï¼</button>
  <span id="bottomOffsetDisplay">0.70</span>
  <button onclick="adjustOffset('bottom', 0.02)">ï¼‹</button>
  <br>
  
  <button onclick="changeColor()">æ–‡å­—é¡è‰²</button>
  <button onclick="showImage()">æ’ç‰ˆç¢ºèª</button>
  <button onclick="downloadImage()">ä¸‹è¼‰åœ–ç‰‡</button>
  
  <br>
  <canvas id="canvas"></canvas>
  <br>
  <img id="outputImage" alt="ç”Ÿæˆçš„åœ–ç‰‡å°‡é¡¯ç¤ºåœ¨é€™è£¡">

  <!-- å¼•å…¥ JS -->
  <script src="app.js"></script>
</body>
</html>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
let img = new Image();
img.crossOrigin = "anonymous";

let topSize = 0.08;
let bottomSize = 0.04;
let style = { fill: "black", stroke: "white" };

let topOffset = 0.15;
let bottomOffset = 0.70;

const boringQuotes = [
  "ä»Šå¤©çš„æˆ‘ï¼Œå·²ç¶“ä¸å†æ˜¯æ˜¨å¤©çš„æˆ‘ã€‚",
  "èººå¹³é‚„åœ¨å‘¼å¸ä¹Ÿæ˜¯ä¸€ç¨®ç”Ÿæ´»æ–¹å¼ã€‚",
  "äº‹æƒ…ä¸å¤šï¼Œä½†æ™‚é–“ç”¨åœ¨ç™¼å‘†ã€‚",
  "æœ›è‘—å¤©èŠ±æ¿ï¼Œæ€è€ƒäººç”Ÿçš„æ„ç¾©ã€‚",
  "å’–å•¡å–å®Œäº†ï¼Œç„¡èŠé‚„æ²’æ‰“ç®—èµ°ã€‚",
  "æ»‘æ‰‹æ©Ÿæ»‘åˆ°æ‰‹æŒ‡ç ´çš®ã€‚",
  "ä»Šå¤©çš„æ–°èéƒ½æ˜¯éå»çš„äº‹ã€‚",
  "å¤§è²å•å€™ç„¡äººå³¶çš„å„ä½ã€‚",
  "æƒ³è·Ÿè‡ªå·±å°è©±å»æƒ³èµ·é‚„åœ¨å†·æˆ°ã€‚",
  "ä¸Šæ¬¡æ”¶åˆ°ç”Ÿæ—¥ç¦®ç‰©å·²ç¶“éä¸€å¹´ã€‚",
  "æ‰‹æ©Ÿé—œéœéŸ³å¾Œç™¼ç¾æ•´å¤©æ²’äººæ‰¾æˆ‘ã€‚",
  "ç„¡èŠæ˜¯ä¸€ç¨®å¹³å‡¡çš„æµªæ¼«ã€‚",
  "ä»Šå¤©çš„äº®é»ï¼šæ²’æœ‰äº®é»ã€‚",
  "ç„¡èŠåˆ°é–‹å§‹æ•¸è‡ªå·±æ‰“äº†å¹¾æ¬¡å“ˆæ¬ ã€‚"
];

function getRandomQuote() {
  const index = Math.floor(Math.random() * boringQuotes.length);
  return boringQuotes[index];
}

window.onload = function() {
  img.src = "IMG_5776.jpeg"; 
  img.onload = () => {
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    generate(); 
  };
};

document.getElementById("upload").addEventListener("change", function(e) {
  const reader = new FileReader();
  reader.onload = function(event) {
    img.src = event.target.result;
    img.onload = () => {
      canvas.width = img.width;
      canvas.height = img.height;
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    };
  };
  reader.readAsDataURL(e.target.files[0]);
});

function adjustSize(target, delta) {
  if (target === 'top') {
    topSize = Math.max(0.01, topSize + delta);
    document.getElementById("topSizeDisplay").innerText = topSize.toFixed(2);
  } else {
    bottomSize = Math.max(0.01, bottomSize + delta);
    document.getElementById("bottomSizeDisplay").innerText = bottomSize.toFixed(2);
  }
  generate();
}

function adjustOffset(target, delta) {
  if (target === 'top') {
    topOffset = Math.min(0.5, Math.max(0.05, topOffset + delta));
    document.getElementById("topOffsetDisplay").innerText = topOffset.toFixed(2);
  } else {
    bottomOffset = Math.min(0.9, Math.max(0.50, bottomOffset + delta));
    document.getElementById("bottomOffsetDisplay").innerText = bottomOffset.toFixed(2);
  }
  generate();
}

function changeColor() {
  const colors = ["red", "blue", "green", "purple", "orange", "brown", "black"];
  const fill = colors[Math.floor(Math.random() * colors.length)];
  style = { fill: fill, stroke: "white" };
  generate();
}

function drawTextWithStroke(text, x, y, fontSizeRatio, style) {
  const fontSize = Math.round(canvas.height * fontSizeRatio);
  ctx.font = `bold ${fontSize}px sans-serif`;
  ctx.textAlign = "center";
  ctx.lineWidth = Math.max(2, fontSize / 15);
  ctx.strokeStyle = style.stroke;
  ctx.fillStyle = style.fill;
  ctx.strokeText(text, x, y);
  ctx.fillText(text, x, y);
}

function getDateInfo() {
  const today = new Date();
  const dateStr = `${today.getFullYear()}å¹´${today.getMonth()+1}æœˆ${today.getDate()}æ—¥`;
  const weekStr = ["æ˜ŸæœŸæ—¥","æ˜ŸæœŸä¸€","æ˜ŸæœŸäºŒ","æ˜ŸæœŸä¸‰","æ˜ŸæœŸå››","æ˜ŸæœŸäº”","æ˜ŸæœŸå…­"][today.getDay()];
  return `${dateStr} ${weekStr}`;
}

async function getWeather(city) {
  try {
    const response = await fetch("https://opendata.cwa.gov.tw/api/v1/rest/datastore/F-C0032-001?Authorization=CWA-A6F3874E-27F3-4AA3-AF5A-96B365798F79&format=JSON");
    const data = await response.json();
    const location
